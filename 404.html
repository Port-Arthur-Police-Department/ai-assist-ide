<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <script>
      // Clear any old service workers and caches
      (function() {
        // Clear service workers
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for (var i = 0; i < registrations.length; i++) {
              registrations[i].unregister();
              console.log('Unregistered service worker:', registrations[i].scope);
            }
          });
        }

        // Clear caches
        if ('caches' in window) {
          caches.keys().then(function(cacheNames) {
            cacheNames.forEach(function(cacheName) {
              // Delete caches from old projects
              if (cacheName.includes('scheduler') || !cacheName.includes('ai-assist-ide')) {
                caches.delete(cacheName);
                console.log('Deleted cache:', cacheName);
              }
            });
          });
        }

        // Redirect to main app
        var currentPath = window.location.pathname;
        var basePath = '/ai-assist-ide';
        
        // If we're not at the correct base path, redirect
        if (!currentPath.startsWith(basePath + '/') && currentPath !== basePath) {
          var newUrl = basePath + '/';
          var search = window.location.search;
          var hash = window.location.hash;
          
          if (search) newUrl += search;
          if (hash) newUrl += hash;
          
          console.log('Redirecting to:', newUrl);
          window.location.replace(newUrl);
        }
      })();
    </script>
  </head>
  <body>
    <noscript>
      <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
        <h1>JavaScript Required</h1>
        <p>Please enable JavaScript to use this application.</p>
        <p><a href="/ai-assist-ide/">Click here to go to the application</a></p>
      </div>
    </noscript>
    
    <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
      <h1>Redirecting...</h1>
      <p>If you are not redirected automatically, <a href="/ai-assist-ide/">click here</a>.</p>
    </div>

    <!-- Fallback redirect -->
    <script>
      setTimeout(function() {
        if (!window.location.pathname.startsWith('/ai-assist-ide')) {
          window.location.replace('/ai-assist-ide/');
        }
      }, 1000);
    </script>
  </body>
</html>
